## XSS跨站脚本攻击

这里本来应该叫做CSS（cross site scripting），为了避免和CSS搞混了，才改为XSS。

简单来说，就是往 HTML 文件中或者 DOM 中注入恶意的script脚本，从而在页面打开时运行并获取一些用户的敏感信息，达到攻击用户的目的。最典型的比如窃取用户的cookie并私自上传到服务器。而注入的方式就有很多种，比如直接类似什么评论直接提交一段script代码啦这样的。

总之，XSS的关键在于S，也就是Script。

怎么来预防呢？其实最主要的手段无非这两种：

1. 特殊符号转义。比如： `<script>`标签会被转义成`&lt;script&gt;`，这样就变成了显示而不是执行。页面上还是正常显示括号，但是更安全了。前端要转义，后端更要转义；

2. 看到script标签直接过滤掉，理它那么多。


## CSRF跨站请求伪造

关键在R，也就是Request。

CSRF是指在用户已经登陆的前提下，利用用户的cookie私自发送一些奇奇怪怪的get/post请求到服务器，让服务器误以为是用户本人在操作。比如：用别人的账号给自己买东西，让别人给自己转账等。

注意：CSRF一般发生在第三方网站，由于同源策略的限制，这些三方网站不能够读取当前所在网站的Cookie，但是如果对Cookie没有做有有效的防护，会在跨站请求中携带该Cookie，这就危险了。

而发送请求的方式，最常见就是把get请求嵌入img标签中，类似这样：

```html
 <img src="http://bank.example/withdraw?amount=10000&for=hacker" > 
```

当然，也可以自动发送post请求，也就是所谓的“自动表单提交”。

总之，CSRF就是借助cookie来模拟一个“假用户”，从而欺骗服务器。

防护策略主要有以下几种：

1. 增加验证码机制，确保一定是用户本人亲手操作的；
2. 验证访问源（Origin/referrer），浏览器在向服务器发送请求的时候会携带一个Origin信息，服务器发现如果不是信任的Origin就直接拒掉；
3. 利用Cookie的sameSite属性，现在大部分浏览器的sameSite默认都是Lax，这是一种比较严格的Cookie保护措施，只在同源网站共享Cookie；
4. 增加token验证。