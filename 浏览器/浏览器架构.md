## ä»€ä¹ˆå«å¹¶è¡Œå¤„ç†ï¼Ÿ

æ‰€è°“å¹¶è¡Œï¼Œå°±æ˜¯è¯´èƒ½åŒæ—¶å¹²å¥½å‡ ä»¶äº‹ã€‚

## è¿›ç¨‹ vs çº¿ç¨‹

è¿›ç¨‹å¤§ï¼Œçº¿ç¨‹å°ã€‚

æˆ‘ä»¬å¯åŠ¨ä¸€ä¸ªç¨‹åºï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªå®ä¾‹ï¼Œè¿™ä¸ªå®ä¾‹æä¾›ä¸€å—å†…å­˜æ¥å­˜æ”¾è¿™ä¸ªå½“å‰ç¨‹åºçš„**é™æ€ä»£ç å’Œè¿è¡ŒçŠ¶æ€**ã€‚æˆ‘ä»¬æŠŠè¿™ä¸ªå®ä¾‹ç§°ä¹‹ä¸ºâ€œè¿›ç¨‹â€ã€‚

çº¿ç¨‹æ˜¯åœ¨è¿›ç¨‹é‡Œé¢å­˜æ´»çš„ï¼Œå¦‚æœæˆ‘ä»¬æŠŠè¿›ç¨‹æ¯”ä½œä¸€ä¸ªå®¹å™¨çš„è¯ï¼Œçº¿ç¨‹å°±æ˜¯åœ¨è¿™ä¸ªå®¹å™¨é‡Œé¢è·‘æ¥è·‘å»å¹²æ´»çš„å°å¼Ÿï¼Œè¿™äº›çº¿ç¨‹å°å¼Ÿå¹²çš„æ´»ï¼Œå°±å«åšâ€œä»»åŠ¡â€ã€‚å‡ ä¸ªçº¿ç¨‹å°å¼ŸåŒæ—¶å¹²æ´»ï¼Œå°±å¯ä»¥æŠŠè¿™ç§æƒ…å†µç§°ä¸ºâ€œå¹¶å‘ä»»åŠ¡â€ã€‚

åœ¨è¿™ä¸ªå®¹å™¨é‡Œé¢æœ‰è¿™æ ·ä¸¤ä¸ªç‰¹ç‚¹ï¼š

- å¦‚æœå®¹å™¨é‡Œé¢çš„æŸä¸ªçº¿ç¨‹å°å¼ŸæŒ‚äº†ï¼Œè¿™ä¸ªå®¹å™¨å¯èƒ½ä¹Ÿä¼šå—åˆ°å½±å“å¹¶ä¸”ç›´æ¥æŒ‚æ‰ï¼›
- æ‰€æœ‰çš„çº¿ç¨‹å°å¼Ÿä¹‹é—´å¯ä»¥å…±äº«æ•°æ®ï¼Œå½¼æ­¤æ²¡ä»€ä¹ˆéšç§å¯è¨€ï¼›
- å½“è¿›ç¨‹å®¹å™¨è¢«æ‰“ç¢ï¼Œè¿™å—å†…å­˜ç©ºåœ°å°±å¾—è¢«å›æ”¶æ‰ â™»ï¸ï¼Œè…¾å‡ºåœ°æ–¹ç»™åˆ«äººç”¨ï¼›
- å„ä¸ªè¿›ç¨‹å®¹å™¨ä¹‹é—´ç›¸äº’éš”ç¦»ï¼Œäº’ä¸å½±å“ã€‚å¦‚æœéœ€è¦é€šä¿¡ï¼Œåˆ™éœ€è¦ä½¿ç”¨ç‰¹æ®Šçš„ IPC è¿›ç¨‹é—´é€šä¿¡ç®¡é“ã€‚

## æµè§ˆå™¨ç»“æ„

ä¸€ä¸ªæµè§ˆå™¨å¤§è‡´å¯ä»¥åˆ†ä¸º**ç”¨æˆ·ç•Œé¢ã€æµè§ˆå™¨å¼•æ“ã€æ¸²æŸ“å¼•æ“**ä¸‰å¤§éƒ¨åˆ†ã€‚

è¿™é‡Œçš„ç”¨æˆ·ç•Œé¢æŒ‡çš„æ˜¯çª—å£å¤´ä¸Šçš„æ“ä½œåŒºåŸŸï¼Œæ¯”å¦‚åœ°å€æ ã€å‰è¿›åé€€æŒ‰é’®ã€ä¹¦ç­¾æ ç­‰ã€Tab æ ‡ç­¾é¡µç­‰ã€‚

æµè§ˆå™¨å¼•æ“ï¼Œè™½ç„¶è¿™ä¸ªåå­—å¾ˆå”¬äººï¼Œä½†æ˜¯å®é™…ä¸Šè¿™ç©æ„åªæ˜¯ä¸ªè·‘è…¿çš„ï¼Œå®ƒè´Ÿè´£åœ¨ç”¨æˆ·ç•Œé¢å’Œæ¸²æŸ“å¼•æ“ä¹‹é—´ä¼ é€’æŒ‡ä»¤ã€‚

æ¸²æŸ“å¼•æ“å°±æ˜¯è´Ÿè´£æŠŠé¡µé¢æ¸²æŸ“åˆ°çª—å£ä¸­çš„å¼•æ“ï¼Œè¿™ä¸ªæ¸²æŸ“å¼•æ“ä¸ä»…ä»…æ˜¯è¯´ç”»ç”»å›¾é‚£ä¹ˆç®€å•ï¼Œå®é™…ä¸Šå®ƒæ‰æ˜¯æµè§ˆå™¨çš„å¤§ä½¬ï¼Œå®ƒè¿˜æœ‰ä¸ªç‰›é€¼çš„åå­—ï¼Œå«â€œå†…æ ¸â€ã€‚

è¯´åˆ°å†…æ ¸ï¼Œåˆä¸å¾—ä¸è¯´ä¸€ä¸‹å„å¤§ä¸»æµæµè§ˆå™¨çš„å†…æ ¸ï¼š

|   IE    | Safari | Firefox |        Chromeã€Operaã€Edge        | 360 æµè§ˆå™¨ã€QQ æµè§ˆå™¨ã€æœç‹—æµè§ˆå™¨ |
| :-----: | :----: | :-----: | :-------------------------------: | :-------------------------------: |
| Trident | Webkit |  Gecko  | åŸºäºå¼€æº webkit æ”¹é€ çš„ blink å†…æ ¸ |       Trident+Blink åŒå†…æ ¸        |

è¿™é‡Œè¦ç€é‡è¯´ä¸€ä¸‹ webkit å’Œ blinkï¼Œé¦–å…ˆ webkit æ˜¯è‹¹æœçš„é¦–åˆ›å‘æ˜ï¼Œç‰›çš®ã€‚å‡ºäºå¼€æºç²¾ç¥ï¼Œè‹¹æœæŠŠè¿™ç©æ„è´¡çŒ®åˆ°äº†ç¤¾åŒºã€‚

å°±è¿å¹³æ—¶ç‰›çš„ä¸è¡Œçš„è°·æ­Œï¼Œä¹Ÿåªæ˜¯å¥—ç”¨ç°æˆçš„ apple å†™å¥½çš„ webkit å†…æ ¸ï¼Œç„¶ååœ¨ä¸Šé¢æ”¹æ”¹ä¸œè¥¿ï¼Œé‡æ–°å‘½å blinkï¼Œå°±åŒ…è£…æˆäº†è‡ªå®¶å†…æ ¸ã€‚åœ¨å‡çº§äº† blink ä¹‹åï¼Œå‡ºäºå†å²å…¼å®¹æ€§çš„è€ƒè™‘ï¼Œ`navigator.userAgent`å¯¹è¿™ä¸€å‡çº§å¹¶æœªæœ‰æ‰€ä½“ç°ï¼Œå…¶å­—æ®µä»æ²¿ç”¨`AppleWebKit`ã€‚

æ¸²æŸ“å¼•æ“ä¸‹é¢ä¸»è¦åŒ…æ‹¬ç½‘ç»œè¯·æ±‚æ¨¡å—ã€JS è§£é‡Šå™¨è¿™ä¸¤ä¸ªå¤§å¤´ã€‚

ç”¨æˆ·ç•Œé¢

## å¤è€çš„å•è¿›ç¨‹æµè§ˆå™¨æ—¶ä»£

è¿™é‡Œä¸»è¦æ˜¯åæ§½ä¸€ä¸‹å•è¿›ç¨‹æµè§ˆå™¨å­˜åœ¨çš„ä¸‰ä¸ªç¼ºç‚¹ã€‚

å¾ˆä¹…å¾ˆä¹…ä»¥å‰ï¼Œæµè§ˆå™¨å…¶å®æ˜¯å•è¿›ç¨‹çš„ï¼Œé‡Œé¢åŒ…æ‹¬é¡µé¢æ¸²æŸ“çº¿ç¨‹ã€JS çº¿ç¨‹ç­‰ã€‚å®ƒçš„ç¼ºç‚¹ä¸»è¦å¦‚ä¸‹ï¼š

- æ ¹æ®è¿›ç¨‹å’Œçº¿ç¨‹çš„å…³ç³»æˆ‘ä»¬çŸ¥é“ï¼Œä¸€ä¸ªçº¿ç¨‹æŒ‚äº†ï¼Œå…¶æ‰€åœ¨çš„æ•´ä¸ªè¿›ç¨‹å¯èƒ½ä¼šæŒ‚ï¼Œæ‰€ä»¥è¯´ç¬¬ä¸€ä¸ªç¼ºç‚¹æ˜¯**ä¸ç¨³å®š**
- æ ¹æ®è¿›ç¨‹å’Œçº¿ç¨‹çš„å…³ç³»æˆ‘ä»¬åˆçŸ¥é“ï¼šåŒä¸€ä¸ªè¿›ç¨‹å†…çš„æ‰€æœ‰çº¿ç¨‹æ˜¯æ— éšç§å…±äº«æ•°æ®çš„ï¼Œ JS çº¿ç¨‹èƒ½è·å¾—æµè§ˆå™¨å½“å‰è¿›ç¨‹çš„æ‰€æœ‰æ•°æ®ï¼Œè¿™æ˜¯ç¬¬äºŒä¸ªç¼ºç‚¹ï¼š**ä¸å®‰å…¨**
- è¿˜æœ‰å°±æ˜¯ä¸€ä¸ªçº¿ç¨‹è´Ÿè´£çš„ä¸œè¥¿å¤ªå¤šï¼Œè¿™å°±å¯¼è‡´ç¬¬ä¸‰ä¸ªç¼ºç‚¹ï¼š**ä¸æµç•…**

## ç°ä»£åŒ–çš„å¤šè¿›ç¨‹æµè§ˆå™¨ç»“æ„

ç°ä»£æµè§ˆå™¨æ˜¯å¤šè¿›ç¨‹çš„ç»“æ„ï¼Œç®€å•æ¥è¯´ï¼Œä¸€ä¸ªæ ‡ç­¾é¡µå°±å¯¹åº”ä¸€ä¸ªç‹¬ç«‹çš„æ¸²æŸ“å™¨è¿›ç¨‹ã€‚æ‰€ä»¥ï¼Œä½ å¼€å¾ˆå¤šå°‘ä¸ªæ ‡ç­¾é¡µï¼Œå°±ä¼šå¯åŠ¨å¤šå°‘ä¸ªè¿›ç¨‹ï¼Œè¿™æ ·è™½ç„¶æœ‰ç‚¹åºŸå†…å­˜ç©ºé—´ï¼Œä½†ç¡®å®æ˜¯æœ€å®‰å…¨çš„ï¼Œå› ä¸ºä¸åŒæ ‡ç­¾é¡µå¯¹åº”çš„ä¸åŒè¿›ç¨‹ä¹‹é—´äº’ä¸å½±å“ã€‚

ç°ä»£æµè§ˆå™¨æ ¹æ®åŠŸèƒ½ä¸åŒï¼Œä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ç§è¿›ç¨‹ï¼š

- æµè§ˆå™¨è¿›ç¨‹ã€‚è¿™ä¸ªè¿›ç¨‹è´Ÿè´£**ç”¨æˆ·ç•Œé¢**ï¼Œä¹Ÿå°±æ˜¯åœ°å€æ ï¼Œä¹¦ç­¾æ ï¼Œå‰è¿›åé€€æŒ‰é’®é‚£ä¸€å †ä¸œè¥¿ã€‚å¦å¤–è¿™ä¸ªè¿›ç¨‹ä¹Ÿæ˜¯ä¸ªå¤§ç»„é•¿ï¼Œè´Ÿè´£æµè§ˆå™¨é‡Œé¢ä¸åŒè¿›ç¨‹ä¹‹é—´çš„å·¥ä½œåè°ƒ
- æ¸²æŸ“å™¨è¿›ç¨‹ã€‚ è´Ÿè´£çª—å£çš„å†…å®¹æ˜¾ç¤ºï¼Œæ¯ä¸ªæ ‡ç­¾é¡µéƒ½ä¼šå¯¹åº”ä¸€ä¸ªæ¸²æŸ“å™¨è¿›ç¨‹
- ç½‘ç»œè¿›ç¨‹ã€‚è´Ÿè´£æç½‘ç»œè¯·æ±‚çš„
- GPU è¿›ç¨‹ã€‚å°±æ˜¯ä¸ªç”»å›¾ã€ç»˜åˆ¶é¡µé¢çš„
- æ’ä»¶è¿›ç¨‹ã€‚è´Ÿè´£ç®¡ç†æµè§ˆå™¨æ’ä»¶ï¼ˆå¦‚ flashï¼‰
- ç¼“å­˜è¿›ç¨‹ã€‚è´Ÿè´£æç¼“å­˜çš„

## ä¸ºä»€ä¹ˆè¯´ JS æ˜¯å•çº¿ç¨‹çš„

JS å•çº¿ç¨‹æŒ‡çš„æ˜¯è¯´ï¼š**åœ¨ä¸€ä¸ªæ¸²æŸ“å™¨è¿›ç¨‹ä¸­ï¼Œæœ‰ä¸”åªæœ‰ä¸€ä¸ª JS çº¿ç¨‹åœ¨å·¥ä½œã€‚**

è¿™æ ·å¯ä»¥ä¿è¯ DOM çš„æ“ä½œå¯é æ€§ã€‚å‡å¦‚æœ‰å¤šä¸ª JS çº¿ç¨‹åŒæ—¶å·¥ä½œï¼Œä¸€ä¸ª JS çº¿ç¨‹åœ¨åˆ é™¤è¯¥ DOMï¼Œå¦ä¸€ä¸ª JS çº¿ç¨‹å´åœ¨è·å–è¯¥ DOM çš„ä¿¡æ¯ï¼Œè¿™æ ·å°±æ²¡æ³•ä¿è¯æ“ä½œçš„å¯é æ€§ã€‚

## JS æ‰§è¡Œçº¿ç¨‹ä¸ UI çº¿ç¨‹äº’æ–¥çš„æ ¹æœ¬åŸå› 

è¿™ä¸¤è€…äº’æ–¥çš„æ ¹æœ¬åŸå› åœ¨äºï¼š**JS æ˜¯å¯ä»¥æ“ä½œ DOMï¼Œå¯¼è‡´æ ·å¼æ”¹å˜çš„ã€‚**

å‡è®¾æœ‰ 4 ä¸ªçº¢è‰²çš„ div ç­‰å¾…æ¸²æŸ“åˆ°é¡µé¢ä¸Šï¼ŒJS çº¿ç¨‹å’Œ UI çº¿ç¨‹åŒæ—¶å¯åŠ¨ã€‚UI çº¿ç¨‹åœ¨æ‹¿ç€â€œ4 ä¸ªçº¢è‰² divâ€çš„ç¨¿å­è€è€å®å®ç”»ç€å›¾ï¼ŒJS çº¿ç¨‹æ¥æ£ä¸€æ‰‹ä¹±ï¼ŒæŠŠ div æ”¹ä¸ºè“è‰²åŒæ—¶æ•°é‡ç¼©å‡ä¸º 3 ä¸ªã€‚é‚£ä»£ç è·Ÿé¡µé¢å±•ç¤ºæ•ˆæœå°±ä¸ä¸€è‡´äº†ã€‚

æ‰€ä»¥ï¼Œä¸ºäº†é¿å…è¿™ç§ä»£ç æ•°æ®è·Ÿé¡µé¢å±•ç¤ºä¸ä¸€è‡´çš„å¼‚å¸¸æƒ…å†µï¼Œæµè§ˆå™¨å°† JS çº¿ç¨‹å’Œ UI çº¿ç¨‹è®¾ç½®æˆäº†äº’æ–¥çš„å…³ç³»ï¼Œå½“ JS çº¿ç¨‹åœ¨å¹²æ´»æ—¶ï¼ŒUI çº¿ç¨‹ä¼šè¢«æŒ‚èµ·æ¥ï¼Œæ™¾åœ¨ä¸€è¾¹ä¹–ä¹–ç­‰å¾…ã€‚ç­‰åˆ° JS çº¿ç¨‹æŠŠæ´»å¹²å®Œå–˜å£æ°”çš„æ—¶å€™ï¼ŒUI çº¿ç¨‹æ‰ä¼šè·‘å‡ºæ¥æ‰§è¡Œä¸€éã€‚

## æµè§ˆå™¨çš„å¼‚æ­¥æœºåˆ¶å¦‚ä½•å®ç°ï¼Ÿ

æµè§ˆå™¨çš„å¼‚æ­¥æœºåˆ¶æ˜¯ç”±ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„å¸¸é©»çº¿ç¨‹å®Œæˆã€‚

æ¯”å¦‚å¼‚æ­¥è¯·æ±‚ï¼Œå…ˆæ˜¯**JS æ‰§è¡Œçº¿ç¨‹**è§£æåˆ°æ­¤å¤„æ˜¯ä¸€ä¸ªå¼‚æ­¥è¯·æ±‚ï¼Œç„¶åç”±**http å¼‚æ­¥è¯·æ±‚çº¿ç¨‹**å‘èµ·å¼‚æ­¥è¯·æ±‚ï¼Œç„¶åæœªæ¥æŸä¸€æ—¶åˆ»**äº‹ä»¶è§¦å‘çº¿ç¨‹**çµæ•åœ°å¯Ÿè§‰åˆ°è¯·æ±‚å·²ç»å®Œæˆäº†ï¼Œå°±ä¼šæŠŠå®Œæˆåçš„å›è°ƒæ’å…¥åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—æœ«å°¾é‡Œç­‰å¾…è¢«æ‰§è¡Œï¼›

åˆæ¯”å¦‚`setTimeout`è¿™ç§ä¸œè¥¿ï¼Œå…ˆæ˜¯**JS æ‰§è¡Œçº¿ç¨‹**è§£æåˆ°æ­¤å¤„æ˜¯ä¸€ä¸ªå®šæ—¶å™¨åŠ¨ä½œï¼Œç„¶åè¿™éƒ¨åˆ†ä»£ç æ”¾åˆ°**å®šæ—¶å™¨çº¿ç¨‹**å»åšå€’è®¡æ—¶ï¼Œå€’è®¡æ—¶å®Œæˆåï¼Œ**å®šæ—¶å™¨çº¿ç¨‹**å†æŠŠå¯¹åº”çš„å›è°ƒå‡½æ•°æ’å…¥åˆ°å®ä»»åŠ¡é˜Ÿåˆ—æœ«å°¾é‡Œç­‰å¾…è¢«æ‰§è¡Œ

## æµè§ˆå™¨çš„ V8 åƒåœ¾å›æ”¶æœºåˆ¶

è¿™é‡Œè¯´çš„å †ä¸­çš„åƒåœ¾å›æ”¶ã€‚

åœ¨è€ä¸€ä»£æµè§ˆå™¨ä¸­ï¼Œæµè§ˆå™¨å¯¹äºåƒåœ¾å›æ”¶çš„ç­–ç•¥æ˜¯â€œå¼•ç”¨è®¡æ•°â€ï¼Œè¿™æ˜¯ä¸€ç§æ¯”è¾ƒå¤è€çš„æ–¹æ³•ã€‚

è€Œåœ¨ç°ä»£æµè§ˆå™¨ä¸­ï¼Œåˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯ä¸æ˜¯åƒåœ¾æ•°æ®ï¼Œéƒ½æ˜¯çœ‹è¿™ä¸ªå¯¹è±¡çš„å¯è¾¾æ€§ï¼ˆèƒ½ä¸èƒ½è¢«è®¿é—®åˆ°ï¼‰ï¼Œå¦‚æœä¸èƒ½åœ¨ä»»ä½•åœ°æ–¹è¢«è®¿é—®åˆ°ï¼Œå°±ä¼šè¢«æ ‡è®°ä¸ºå­¤å²›æ•°æ®ï¼Œä¹Ÿå°±æ˜¯åƒåœ¾æ•°æ®ã€‚

â€œæ ‡è®°-æ¸…é™¤â€ï¼Œæ˜¯ç°ä»£æµè§ˆå™¨åƒåœ¾å›æ”¶çš„æ ¸å¿ƒæœºåˆ¶ã€‚åœ¨ v8 å†…æ ¸çš„æµè§ˆå™¨ä¸­ï¼Œä¼šåŸºäºè¿™ä¸ªæœºåˆ¶åšä¸€äº›æ›´åŠ å…¨é¢çš„æ‰©å±•ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„â€œ**åˆ†ä»£å›æ”¶æœºåˆ¶**â€ï¼Œå…·ä½“å¦‚ä¸‹ï¼š

- å †å†…å­˜ä¼šè¢«åˆ†ä¸ºâ€œæ–°ç”Ÿä»£ç©ºé—´â€å’Œâ€œè€ç”Ÿä»£ç©ºé—´â€
- æ–°ç”Ÿä»£ç©ºé—´å°ï¼Œä¸€èˆ¬ç”¨æ¥å­˜æ”¾ä¸€äº›â€œçŸ­å‘½é¬¼â€ï¼›è€ç”Ÿä»£ç©ºé—´å¤§ï¼Œä¸€èˆ¬ç”¨æ¥å­˜æ”¾ä¸€äº›â€œè€æ²¹æ¡â€
- æ–°ç”Ÿä»£ç©ºé—´é‡Œé¢åˆè¢«åˆ’åˆ†ä¸ºå¯¹è±¡åŒºã€ç©ºé—²åŒºï¼Œè¿™ä¸¤ä¸ªç©ºé—´åœ¨æ‰§è¡Œåƒåœ¾å›æ”¶æ—¶ä¼šâ€œç›¸äº’å€’è…¾â€
- è€ç”Ÿä»£ç©ºé—´ä¸»è¦æœºåˆ¶æ˜¯â€œæ ‡è®°-æ¸…é™¤â€+â€œæ ‡è®°-æ•´ç†â€

### æ–°ç”Ÿä»£æ€ä¹ˆå›æ”¶

åœ¨æ–°ç”Ÿä»£ç©ºé—´æ‰§è¡Œåƒåœ¾å›æ”¶æ—¶ï¼Œä¼šâ€œç›¸äº’å€’è…¾â€ï¼Œè¿™ä¸ªæ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿå¯¹è±¡åŒºé¡¾åæ€ä¹‰å°±æ˜¯ç”¨æ¥å­˜æ”¾æµè§ˆå™¨è®¤ä¸ºçš„â€œçŸ­å‘½é¬¼â€å¯¹è±¡çš„ï¼›è€Œç©ºé—²åŒºåŸŸé¡¾åæ€ä¹‰å°±æ˜¯ç©ºé—²çš„ã€‚å½“å¯¹è±¡åŒºå†…å­˜ä¸è¶³çš„æ—¶å€™ï¼Œå°±ä¼šå¯¹å¯¹è±¡åŒºé‡Œé¢çš„æ‰€æœ‰å¯¹è±¡è¿›è¡Œæ ‡è®°ï¼Œå¯è¾¾çš„å¯¹è±¡ä¼šè¢«ä¾æ¬¡å¤åˆ¶å‰ªåˆ‡åˆ°ç©ºé—²åŒºï¼Œä¸å¯è¾¾çš„æ•°æ®åˆ™æ¸…é™¤æ‰ã€‚

å½“è¿™ä¸ªåŠ¨ä½œå®Œæˆä»¥åï¼Œå¯¹è±¡åŒºå’Œç©ºé—²åŒºçš„è§’è‰²ä¹Ÿå°±äº’æ¢äº†ã€‚

ç„¶è€Œæ–°ç”Ÿä»£ç©ºé—´çš„å®¹é‡æ¯•ç«Ÿæ˜¯æœ‰é™çš„ï¼Œå½“å€’è…¾ä¸¤æ¬¡åï¼Œä»ç„¶å­˜æ´»çš„å¯¹è±¡å°†æ™‹å‡åˆ°æ›´åŠ å¹¿é˜”çš„è€ç”Ÿä»£ç©ºé—´ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå ç”¨å¯¹è±¡åŒºç©ºé—´è¶…è¿‡ 25%çš„å¤§å‹å¯¹è±¡ä¹Ÿä¼šæ™‹å‡åˆ°è€ç”Ÿä»£ç©ºé—´ã€‚

### è€ç”Ÿä»£æ€ä¹ˆå›æ”¶

è€ç”Ÿä»£ç©ºé—´ç”±äºèŒƒå›´æ¯”è¾ƒå¤§ï¼Œå¯¹è±¡ä½“ç§¯æ™®éä¹Ÿæ¯”è¾ƒå¤§ï¼Œå°±ä¸å¤ªé€‚åˆå¤åˆ¶è¿™ç§è€—æ—¶æ“ä½œäº†ï¼Œå®ƒä¸»è¦ä½¿ç”¨çš„æ‰‹æ³•æ˜¯*æ ‡è®°-æ¸…é™¤*å’Œ*æ ‡è®°-æ•´ç†*ã€‚

æ ‡è®°-æ¸…é™¤å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯åœ¨ä¸€è½®æ ‡è®°åï¼Œå°†å­¤å²›æ•°æ®åŸåœ°æ¸…é™¤ã€‚

ä½†æ˜¯åŸåœ°æ¸…é™¤è¿™ä¸ªæ“ä½œä¹Ÿä¼šå¸¦æ¥å¤§é‡çš„ä¸è¿ç»­å†…å­˜ç©ºé—´ï¼Œä¿—ç§°â€œå†…å­˜ç¢ç‰‡â€ã€‚ä¸ºäº†å°½å¯èƒ½åœ°ç©ºå‡ºè¿ç»­å†…å­˜ï¼Œéœ€è¦å¯¹å­˜æ´»çš„è€æ²¹æ¡å¯¹è±¡ä»¬è¿›è¡Œæ•´ç†ï¼Œç®€å•æ¥è¯´ï¼š_å°±æ˜¯å°½å¯èƒ½å¾€è€ç”Ÿä»£ç©ºé—´æŸçš„ä¸€ç«¯æŒ¤ï¼Œç©ºå‡ºè¿ç»­çš„â€œå†…å­˜ç©ºåœ°â€ã€‚_

## å…³äº postMessage

`postMessage`å¸¸ç”¨äºä¸¤ä¸ªçª—å£ä¹‹é—´çš„é€šä¿¡ï¼Œæœ€å…¸å‹çš„åœºæ™¯å°±æ˜¯ï¼š**ä¸€ä¸ªé¡µé¢åµŒå¥—ä¸€ä¸ª iframeï¼Œçˆ¶é¡µé¢å’Œ iframe ä¹‹é—´äº’å‘æ¶ˆæ¯è¿›è¡Œé€šä¿¡**ã€‚

`postMessage`æœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯å¯ä»¥è·¨åŸŸï¼Œæ³¨æ„ï¼š`postMessage`çš„è°ƒç”¨çª—å£æ˜¯è¦å‘é€çš„çª—å£ï¼Œä¹Ÿå°±æ˜¯ç›®æ ‡çª—å£ï¼Œè€Œä¸æ˜¯å½“å‰çª—å£ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªæ¯”è¾ƒå®¹æ˜“æé”™çš„åœ°æ–¹ã€‚

```js
// çˆ¶é¡µé¢
const iframe = document.querySelector("#ifr");
iframe.onload = function() {
  iframe.contentWindow.postMessage("æ¥è‡ªçˆ¶ç»„ä»¶çš„æ¶ˆæ¯", iframe.src);
}

window.onmessage = (e) => {
  console.log("å­é¡µé¢å‘è¿‡æ¥çš„æ¶ˆæ¯ä¸º", e.data);
};
```

```html
<!-- çˆ¶é¡µé¢ -->
<iframe src="http://192.168.96.171:8080/" id="ifr" title="å­é¡µé¢" />
```

é‚£ä¹ˆåœ¨ iframe å­é¡µé¢ï¼Œå°±å¯ä»¥è¿™æ ·ï¼š

```js
window.onmessage = function (e) {
  if (e.source !== window.parent) return; // åˆ¤æ–­ä¸€ä¸‹æ˜¯ä¸æ˜¯çˆ¶é¡µé¢ä¼ è¿‡æ¥çš„ï¼Œè¿‡æ»¤ä¸€ä¸‹ï¼Œè¿™æ ·æ¯”è¾ƒå®‰å…¨
  console.log("çˆ¶é¡µé¢é¢å‘çš„æ¶ˆæ¯ä¸ºï¼š", e.data);
};

window.parent.postMessage("æˆ‘æ˜¯ä½ çš„å„¿", "http://192.168.0.101:3000"); // æ³¨æ„è¿™é‡Œè¦ç›´æ¥å†™çˆ¶é¡µé¢çš„åœ°å€
// window.parent.postMessage("æˆ‘æ˜¯ä½ çš„å„¿", "*"); // æˆ–è€…ç²—æš´ä¸€ç‚¹ï¼Œä¿¡å·ä¹±å°„
```

## window.BroadcastChannelï¼Œä¸€ä¸ªå­¤ç‹¬çš„åŒæºå¹¿æ’­å™¨

è¿™ä¸ªæ˜¯windowä¸‹é¢çš„ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œç”¨æ¥å®ä¾‹åŒ–ä¸€ä¸ªä¿¡é“ï¼Œä»¥æ¥å…¥æŸä¸ªå¹¿æ’­ğŸ“¢ã€‚

`BroadcastChannel`çš„ä¼˜ç‚¹å¾ˆæ˜æ˜¾ï¼Œä¸åŒäºä¼ ç»Ÿçš„`postMessage`ç‚¹å¯¹ç‚¹çš„é€šä¿¡ï¼Œè¿™ä¸ªæ˜¯å¯ä»¥ä¸€å¯¹å¤šçš„ã€‚

```js
// Aæ ‡ç­¾é¡µ
var channel1 = new BroadcastChannel('channel_for_emotion');

aa.postMessage('æ‰€æœ‰äººå¬ä»¤'); // è¿™é‡Œä¸ç”¨æŒ‡å®šæŸä¸€ä¸ªoriginï¼Œå› ä¸ºè¿™ä¸ªæ¶ˆæ¯æ˜¯å¹¿æ’­å¼çš„
```

```js
// Bæ ‡ç­¾é¡µï¼Œchannel_for_emotionæ˜¯è¯¥é¢‘é“çš„æ ‡è¯†ï¼Œæ¥å…¥å°±è¡Œäº†
var myChannel = new BroadcastChannel('channel_for_emotion');

myChannel.onmessage = function(e) {
  console.log(e.data); // Aé¡µé¢æ‰§è¡Œå¹¿æ’­åŠ¨ä½œåï¼Œè¿™é‡Œä¼šæ‰“å°å‡ºâ€œæ‰€æœ‰äººå¬ä»¤â€
}
```

å½“ç„¶ï¼Œå®ƒçš„ç¼ºç‚¹ä¹Ÿæ¯”è¾ƒæ˜æ˜¾ï¼š

1. åªèƒ½åŒæºï¼›
2. å…¼å®¹æ€§ä¸€èˆ¬ï¼ŒIEå’Œsafariå…¨ç³»ä¸æ”¯æŒã€‚ï¼ˆè¿™ä¸ªæƒ…å†µå¯èƒ½å¯ä»¥é€šè¿‡polyfillæ¥å‡ç¼“ï¼‰